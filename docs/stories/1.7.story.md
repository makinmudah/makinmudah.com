# Story 1.7: Mobile-First Responsive Design and Performance Optimization

## Status

Draft

## Story

**As a** mobile visitor on 3G connection,
**I want** the landing page to load quickly and be easy to navigate on my smartphone,
**so that** I don't abandon due to slow loading or frustrating mobile experience.

## Acceptance Criteria

1. All landing page sections are fully responsive from 320px (small mobile) to 1920px+ (large desktop)
2. Typography scales fluidly using CSS clamp() or viewport units (no awkward jumps at breakpoints)
3. Images and GIFs are optimized using Nuxt Image module (lazy loading, WebP format, responsive sizes)
4. Total page weight is under 2MB (excluding external scripts like Google Analytics)
5. JavaScript bundle is under 200KB gzipped, CSS under 50KB gzipped
6. Lighthouse performance score is 90+ on mobile simulation (DevTools throttled to 3G)
7. First Contentful Paint (FCP) is under 1.5 seconds on simulated 3G
8. Largest Contentful Paint (LCP) is under 2.5 seconds
9. Cumulative Layout Shift (CLS) is under 0.1 (no content jumps during load)
10. All tap targets are minimum 44x44px on mobile (CTAs, accordion headers)
11. Mobile navigation is thumb-friendly (buttons within easy reach)
12. Test on real mobile device (Chrome Android or Safari iOS) and verify smooth performance

## Tasks / Subtasks

- [ ] **Task 1: Verify Responsive Design Across All Breakpoints (AC: 1, 2)**
  - [ ] Test Hero Section responsiveness (320px, 375px, 640px, 768px, 1024px, 1280px, 1536px, 1920px)
  - [ ] Test Value Propositions Section responsiveness across all breakpoints
  - [ ] Test Problem/Solution Section responsiveness across all breakpoints
  - [ ] Test FAQ Accordion Section responsiveness across all breakpoints
  - [ ] Test Final CTA Section responsiveness across all breakpoints
  - [ ] Test Footer responsiveness across all breakpoints
  - [ ] Test Catalogue Page responsiveness across all breakpoints
  - [ ] Document any responsive design issues found and fix them
  - [ ] Verify no horizontal scrolling on any viewport size

- [ ] **Task 2: Implement Fluid Typography Scaling (AC: 2)**
  - [ ] Audit current typography sizing across all components
  - [ ] Identify typography that jumps awkwardly at breakpoints
  - [ ] Replace fixed breakpoint sizing with CSS clamp() where beneficial
  - [ ] Test typography scaling smoothly from 320px to 1920px+
  - [ ] Verify readability at all viewport sizes
  - [ ] Document typography scale system for future components

- [ ] **Task 3: Optimize Images with Nuxt Image Module (AC: 3, 4)**
  - [ ] Install @nuxt/image module if not already present
  - [ ] Configure Nuxt Image in nuxt.config.ts
  - [ ] Replace static img tags with <NuxtImg> component where applicable
  - [ ] Implement lazy loading for below-the-fold images
  - [ ] Configure WebP format with PNG/JPG fallbacks
  - [ ] Set up responsive image sizes (srcset) for different viewports
  - [ ] Optimize existing image files (compress, resize)
  - [ ] Verify total page weight <2MB (measure in DevTools Network tab)
  - [ ] Test image loading performance on 3G throttled connection

- [ ] **Task 4: Optimize Bundle Sizes (AC: 5)**
  - [ ] Run `npm run build` and analyze bundle sizes
  - [ ] Check JavaScript bundle size (should be <200KB gzipped)
  - [ ] Check CSS bundle size (should be <50KB gzipped)
  - [ ] If over budget, identify largest chunks and optimize
  - [ ] Verify tree-shaking is working (unused code removed)
  - [ ] Check for duplicate dependencies in bundle
  - [ ] Consider code-splitting if needed (dynamic imports)
  - [ ] Verify Tailwind CSS purging is configured correctly
  - [ ] Document bundle sizes and any optimizations made

- [ ] **Task 5: Run Lighthouse Performance Audit (AC: 6, 7, 8, 9)**
  - [ ] Open Chrome DevTools Lighthouse tab
  - [ ] Configure mobile simulation with 3G throttling
  - [ ] Run Lighthouse audit on landing page (/)
  - [ ] Verify Performance score ≥90
  - [ ] Verify First Contentful Paint (FCP) <1.5s
  - [ ] Verify Largest Contentful Paint (LCP) <2.5s
  - [ ] Verify Cumulative Layout Shift (CLS) <0.1
  - [ ] Document Lighthouse scores and Core Web Vitals
  - [ ] If any metric fails, identify and fix the issue
  - [ ] Re-run audit to confirm all targets met
  - [ ] Run Lighthouse on /katalog page and verify similar scores

- [ ] **Task 6: Fix Any Layout Shift Issues (AC: 9)**
  - [ ] Identify sources of layout shift (CLS > 0.1)
  - [ ] Add explicit width/height to images to reserve space
  - [ ] Avoid inserting content above existing content
  - [ ] Use CSS transforms for animations (not position changes)
  - [ ] Preload critical fonts to prevent FOUT/FOIT
  - [ ] Test page load multiple times to verify CLS <0.1
  - [ ] Document any fixes made for CLS issues

- [ ] **Task 7: Verify Tap Target Sizes on Mobile (AC: 10, 11)**
  - [ ] Test all CTA buttons on mobile viewport (min 44x44px)
  - [ ] Test FAQ accordion headers on mobile (min 44x44px)
  - [ ] Test footer links if any (min 44x44px)
  - [ ] Test catalogue card buttons on mobile (min 44x44px)
  - [ ] Verify buttons are within thumb-friendly zones
  - [ ] Check spacing between tap targets (min 8px gap)
  - [ ] Fix any tap targets that are too small
  - [ ] Use Chrome DevTools mobile simulation to verify

- [ ] **Task 8: Test on Real Mobile Devices (AC: 12)**
  - [ ] Test on Chrome Android (real device or BrowserStack)
  - [ ] Test on Safari iOS (real device or BrowserStack)
  - [ ] Verify smooth scrolling and animations
  - [ ] Test touch interactions (tap, swipe, pinch-zoom if allowed)
  - [ ] Verify page loads in <3 seconds on real 3G
  - [ ] Check for any mobile-specific rendering issues
  - [ ] Test landscape and portrait orientations
  - [ ] Document any device-specific issues found

- [ ] **Task 9: Performance Optimization Follow-up**
  - [ ] Minify HTML output (verify Nuxt build does this)
  - [ ] Enable gzip/brotli compression (verify on hosting platform)
  - [ ] Implement resource hints (preload, prefetch, dns-prefetch)
  - [ ] Review third-party scripts (minimize or defer)
  - [ ] Optimize font loading (font-display: swap)
  - [ ] Verify critical CSS is inlined
  - [ ] Test caching strategies (browser cache, CDN)
  - [ ] Document all performance optimizations applied

- [ ] **Task 10: Create Performance Budget Script**
  - [ ] Create script to monitor bundle sizes on build
  - [ ] Set up bundle size thresholds (200KB JS, 50KB CSS)
  - [ ] Fail build if budget exceeded (optional for MVP)
  - [ ] Add bundle size tracking to CI/CD pipeline (optional)
  - [ ] Document how to run performance budget checks

- [ ] **Task 11: Write Responsive Design Tests (AC: 1)**
  - [ ] Add E2E tests for responsive behavior at key breakpoints
  - [ ] Test: Hero section displays correctly on mobile (375px)
  - [ ] Test: Value Props section stacks on mobile, side-by-side on desktop
  - [ ] Test: Problem/Solution section adapts layout correctly
  - [ ] Test: FAQ accordion renders properly on all sizes
  - [ ] Test: Catalogue page cards grid adapts (1/2/3 columns)
  - [ ] Test: No horizontal overflow on any viewport
  - [ ] Run tests: `npm run test:e2e`

- [ ] **Task 12: Write Performance Tests (AC: 5, 6, 7, 8, 9)**
  - [ ] Create Lighthouse CI configuration (optional for automated checks)
  - [ ] Add bundle size assertion tests
  - [ ] Document how to run Lighthouse audits locally
  - [ ] Create performance testing checklist for future stories
  - [ ] Verify all performance tests pass

- [ ] **Task 13: Document Performance Baseline**
  - [ ] Record final Lighthouse scores (Performance, Accessibility, SEO, Best Practices)
  - [ ] Record Core Web Vitals (FCP, LCP, CLS, FID)
  - [ ] Record bundle sizes (JS, CSS)
  - [ ] Record page weight (total KB)
  - [ ] Create performance dashboard or report
  - [ ] Add performance metrics to project README

## Dev Notes

### Previous Story Insights

From Story 1.6 (Final CTA Section and Footer):

- **Catalogue page created**: Unified `/katalog` page displaying 6 items (3 apps + 3 mentoring programs)
- **All CTA buttons updated**: Hero, Problem/Solution, and Final CTA now point to `/katalog`
- **Test count**: 246 tests passing (134 component + 112 E2E)
- **Responsive testing pattern**: Tests verify mobile (375px), tablet (768px), desktop (1280px)
- **No 404 errors**: All navigation working correctly

### Performance Targets (from PRD)

**NFR1:** Landing page loads in <3 seconds on 3G connections
[Source: docs/prd.md - NFR1]

**NFR2:** First Contentful Paint (FCP) <1.5 seconds
[Source: docs/prd.md - NFR2]

**NFR3:** Lighthouse scores: Performance 90+, Accessibility 100, SEO 100, Best Practices 90+
[Source: docs/prd.md - NFR3]

**NFR4:** Core Web Vitals: LCP <2.5s, FID <100ms, CLS <0.1
[Source: docs/prd.md - NFR4]

**NFR5:** JavaScript bundle <200KB gzipped, CSS <50KB gzipped
[Source: docs/prd.md - NFR5]

**NFR6:** Fully responsive on mobile (Chrome Android 90+, Safari iOS 13+) and desktop (Chrome 90+, Firefox 88+, Safari 14+, Edge 90+)
[Source: docs/prd.md - NFR6]

### Bundle Size Targets

**JavaScript:**
- Landing page: <100KB gzipped (NOTE: NFR5 says <200KB, but architecture doc says <100KB for landing - use 100KB as target)
- Catalogue pages: <150KB gzipped
- Shared chunks: <50KB gzipped each

**CSS:**
- Global styles: <30KB gzipped
- Page-specific: <20KB gzipped

**Total Page Weight:**
- Landing page: <500KB (including images, fonts)
- Subsequent navigation: <200KB (cached assets)

[Source: docs/ui-architecture.md#2-frontend-tech-stack - Bundle Size Targets]

### Browser Support

**Target Browsers:**
- Chrome 90+ (last 2 versions)
- Firefox 88+ (last 2 versions)
- Safari 14+ (last 2 versions)
- Edge 90+ (last 2 versions)
- Mobile Safari iOS 14+
- Chrome Android 90+

[Source: docs/ui-architecture.md#2-frontend-tech-stack - Browser Support]

### Responsive Design Breakpoints

Tailwind's default breakpoints (used throughout project):

```
sm:  640px   // Small tablets
md:  768px   // Tablets
lg:  1024px  // Laptops
xl:  1280px  // Desktops
2xl: 1536px  // Large desktops
```

**Additional testing breakpoints:**
- 320px: Small mobile (iPhone SE)
- 375px: Standard mobile (iPhone X)
- 1920px: Large desktop

[Source: docs/ui-architecture.md#8-styling-guidelines - Responsive Design Breakpoints]

### Typography Scaling

Use CSS clamp() for fluid typography to avoid awkward jumps:

```css
/* Example from existing Hero section */
font-size: clamp(1.5rem, 5vw, 2rem); /* Mobile */
font-size: clamp(2.5rem, 4vw, 3.5rem); /* Desktop */
```

**Current typography classes:**
- `text-[clamp(...)]` for custom fluid sizing
- Hero headline: `text-[clamp(1.5rem,5vw,2rem)] md:text-[clamp(2rem,4vw,2.5rem)] lg:text-[clamp(2.5rem,4vw,3.5rem)]`

[Source: Inspection of components/landing/HeroSection.vue]

### Nuxt Image Module Configuration

**Installation (if not present):**
```bash
npm install @nuxt/image
```

**Configuration in `nuxt.config.ts`:**
```typescript
export default defineNuxtConfig({
  modules: ['@nuxt/image'],
  image: {
    formats: ['webp', 'png', 'jpg'],
    screens: {
      xs: 320,
      sm: 640,
      md: 768,
      lg: 1024,
      xl: 1280,
      xxl: 1536,
    },
    // Optional: Configure provider (default is ipx for local images)
  },
})
```

**Usage:**
```vue
<template>
  <!-- Replace img with NuxtImg -->
  <NuxtImg
    src="/images/demo.png"
    alt="Demo image"
    width="600"
    height="400"
    loading="lazy"
    format="webp"
    sizes="sm:100vw md:50vw lg:400px"
  />
</template>
```

[Source: Nuxt Image documentation - best practices for this story]

### Lighthouse Testing

**How to run Lighthouse audit:**
1. Open page in Chrome
2. Open DevTools (F12)
3. Go to Lighthouse tab
4. Select "Mobile" device
5. Select "Navigation (Default)"
6. Check "Performance" category
7. Click "Analyze page load"

**Interpreting results:**
- Performance score: Should be 90+
- FCP: First paint of any content (<1.5s target)
- LCP: Largest content fully rendered (<2.5s target)
- CLS: Visual stability during load (<0.1 target)
- TBT: Total Blocking Time (not in AC, but affects score)

**Common issues and fixes:**
- Low LCP: Optimize images, lazy load below-fold content, use WebP
- High CLS: Add width/height to images, avoid dynamic content insertion
- Low Performance Score: Reduce bundle size, minify assets, enable compression

[Source: Common Lighthouse optimization practices]

### Core Web Vitals Details

**First Contentful Paint (FCP):** Time until first text/image is painted
**Target:** <1.5 seconds

**Largest Contentful Paint (LCP):** Time until largest content element is painted
**Target:** <2.5 seconds
**Common LCP elements:** Hero images, large text blocks, hero video

**Cumulative Layout Shift (CLS):** Sum of all unexpected layout shifts
**Target:** <0.1
**Causes:** Images without dimensions, web fonts loading, dynamic content injection

**First Input Delay (FID):** Time from user interaction to browser response
**Target:** <100ms
**Note:** Not directly tested in Lighthouse (uses TBT as proxy)

[Source: docs/prd.md - NFR4]

### Performance Optimization Techniques

**Image Optimization:**
- Use WebP format with fallbacks
- Lazy load images below fold
- Specify width/height to prevent CLS
- Use responsive images (srcset, sizes)
- Compress images before uploading

**JavaScript Optimization:**
- Code splitting (dynamic imports)
- Tree shaking (remove unused code)
- Minification (production build)
- Defer non-critical scripts

**CSS Optimization:**
- Purge unused Tailwind classes (done automatically)
- Inline critical CSS
- Minify CSS
- Use modern CSS features

**Nuxt SSG Benefits:**
- Pre-rendered static HTML (fast FCP)
- No server rendering delay
- Better caching
- Reduced JavaScript needed

[Source: docs/ui-architecture.md - Nuxt SSG configuration]

### File Locations

**Configuration Files:**
- `nuxt.config.ts` - Add Nuxt Image module configuration
- `tailwind.config.ts` - Verify purge configuration
- `package.json` - Check/add @nuxt/image dependency

**Components to Verify:**
- `components/landing/HeroSection.vue`
- `components/landing/ValuePropositions.vue`
- `components/landing/ProblemSolution.vue`
- `components/landing/FaqAccordion.vue`
- `components/landing/FinalCta.vue`
- `components/common/AppFooter.vue`
- `pages/index.vue`
- `pages/katalog.vue`

**Testing:**
- E2E tests: `tests/e2e/*.spec.ts` (add responsive tests)
- No new component tests needed (testing is verification-focused)

### Testing Requirements

**Responsive Testing:**
- Test all components at breakpoints: 320px, 375px, 640px, 768px, 1024px, 1280px, 1536px, 1920px
- Verify no horizontal overflow
- Verify touch targets ≥44x44px on mobile
- Test landscape and portrait modes

**Performance Testing:**
- Run Lighthouse on landing page and catalogue page
- Measure bundle sizes after build
- Test on throttled 3G connection (DevTools Network tab)
- Verify Core Web Vitals in Lighthouse

**Manual Testing:**
- Test on real mobile device (Chrome Android or Safari iOS)
- Verify smooth scrolling
- Test touch interactions
- Measure real-world load time on 3G

[Source: docs/ui-architecture.md#9-testing-requirements + Story AC]

### Technical Constraints

**Performance Budgets (Hard Limits):**
- JavaScript bundle: <200KB gzipped (landing page)
- CSS bundle: <50KB gzipped
- Total page weight: <2MB
- FCP: <1.5s on 3G
- LCP: <2.5s
- CLS: <0.1
- Lighthouse Performance: ≥90

**Responsive Range:**
- Minimum: 320px (iPhone SE)
- Maximum: 1920px+ (large desktop)
- Primary test sizes: 375px, 768px, 1280px

**Tap Target Minimum:**
- 44x44px (WCAG 2.1 AA requirement)
- 8px spacing between targets

[Source: docs/prd.md - NFR1-6, WCAG standards]

### Current Project Status

**Existing Optimizations:**
- ✅ Tailwind CSS with PurgeCSS configured
- ✅ Nuxt 3 SSG (Static Site Generation)
- ✅ TypeScript for type safety
- ✅ Responsive components already built
- ✅ No large images currently in project
- ✅ Minimal JavaScript (mostly Vue components)

**Known Issues to Address:**
- ⚠️ No Nuxt Image module configured yet
- ⚠️ Typography may have breakpoint jumps (need to audit)
- ⚠️ No Lighthouse audit results recorded yet
- ⚠️ Bundle sizes not measured/documented yet
- ⚠️ No performance tests in CI/CD

**Dependencies:**
- Nuxt: ^4.2.2 (latest)
- Vue: ^3.5.26
- Tailwind: ^6.14.0 (via @nuxtjs/tailwindcss)
- Need to add: @nuxt/image (if optimizing images)

[Source: package.json + project inspection]

### Implementation Recommendations

**Recommended Approach: Verification and Optimization**

This story is primarily about verification and optimization rather than building new features.

**Step-by-Step:**
1. **Measure Current State**: Run Lighthouse, check bundle sizes, test responsive design
2. **Identify Issues**: Document any performance or responsive issues
3. **Prioritize Fixes**: Start with highest-impact optimizations
4. **Implement Fixes**: Make targeted improvements
5. **Re-measure**: Verify improvements meet targets
6. **Document**: Record baseline metrics for future reference

**Quick Wins:**
- Add Nuxt Image module (if not present, improves LCP)
- Verify Tailwind purging (reduces CSS size)
- Add explicit image dimensions (fixes CLS)
- Test responsive design (likely already good)

**Time Estimate:**
- Measurement and testing: 30 minutes
- Optimization work: 1-2 hours (depends on issues found)
- Re-testing and documentation: 30 minutes
- Total: 2-3 hours

### Performance Monitoring Tools

**Built-in Tools:**
- Chrome DevTools Lighthouse
- Chrome DevTools Network tab (throttling)
- Chrome DevTools Coverage tab (unused code)
- Chrome DevTools Performance tab (profiling)

**Online Tools:**
- PageSpeed Insights (Google)
- WebPageTest.org
- GTmetrix

**CI/CD Integration (Optional):**
- Lighthouse CI
- Bundle size tracking (webpack-bundle-analyzer)

[Source: Common performance monitoring practices]

## Change Log

| Date       | Version | Description                                   | Author                         |
| ---------- | ------- | --------------------------------------------- | ------------------------------ |
| 2026-01-22 | 1.0     | Initial story draft with architecture context | Claude Sonnet 4.5 (BMad Agent) |

## Dev Agent Record

### Agent Model Used

_To be filled during development_

### Debug Log References

_To be filled during development if issues arise_

### Completion Notes List

_To be filled upon story completion_

### File List

_To be filled upon story completion_

## QA Results

_To be filled after QA validation_
